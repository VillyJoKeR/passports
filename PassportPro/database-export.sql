-- Database Schema for VisaCheck App
-- This script will create the necessary tables and import the visa data

-- Create tables
CREATE TABLE IF NOT EXISTS users (
  id SERIAL PRIMARY KEY,
  username TEXT NOT NULL UNIQUE,
  password TEXT NOT NULL
);

CREATE TABLE IF NOT EXISTS countries (
  id SERIAL PRIMARY KEY,
  code TEXT NOT NULL UNIQUE,
  name TEXT NOT NULL,
  flag TEXT NOT NULL,
  region TEXT
);

CREATE TABLE IF NOT EXISTS visa_requirements (
  id SERIAL PRIMARY KEY,
  from_country_code TEXT NOT NULL,
  to_country_code TEXT NOT NULL,
  status TEXT NOT NULL,
  duration TEXT,
  validity TEXT,
  processing TEXT,
  cost TEXT,
  notes TEXT,
  requirements JSONB,
  last_updated TEXT,
  CONSTRAINT visa_requirements_unique_combo UNIQUE (from_country_code, to_country_code)
);

CREATE TABLE IF NOT EXISTS search_history (
  id SERIAL PRIMARY KEY,
  from_country_code TEXT NOT NULL,
  to_country_code TEXT NOT NULL,
  searched_at TEXT NOT NULL
);

-- Import countries data
INSERT INTO countries (code, name, flag, region) VALUES
-- This is just a sample, the full list contains all countries
('af', 'Afghanistan', 'ğŸ‡¦ğŸ‡«', 'Asia'),
('al', 'Albania', 'ğŸ‡¦ğŸ‡±', 'Europe'),
('dz', 'Algeria', 'ğŸ‡©ğŸ‡¿', 'Africa'),
('ad', 'Andorra', 'ğŸ‡¦ğŸ‡©', 'Europe'),
('ao', 'Angola', 'ğŸ‡¦ğŸ‡´', 'Africa'),
('ag', 'Antigua and Barbuda', 'ğŸ‡¦ğŸ‡¬', 'North America'),
('ar', 'Argentina', 'ğŸ‡¦ğŸ‡·', 'South America'),
('am', 'Armenia', 'ğŸ‡¦ğŸ‡²', 'Asia'),
('au', 'Australia', 'ğŸ‡¦ğŸ‡º', 'Oceania'),
('at', 'Austria', 'ğŸ‡¦ğŸ‡¹', 'Europe'),
('az', 'Azerbaijan', 'ğŸ‡¦ğŸ‡¿', 'Asia'),
('bs', 'Bahamas', 'ğŸ‡§ğŸ‡¸', 'North America'),
('bh', 'Bahrain', 'ğŸ‡§ğŸ‡­', 'Asia'),
('bd', 'Bangladesh', 'ğŸ‡§ğŸ‡©', 'Asia'),
('bb', 'Barbados', 'ğŸ‡§ğŸ‡§', 'North America'),
('by', 'Belarus', 'ğŸ‡§ğŸ‡¾', 'Europe'),
('be', 'Belgium', 'ğŸ‡§ğŸ‡ª', 'Europe'),
('bz', 'Belize', 'ğŸ‡§ğŸ‡¿', 'North America'),
('bj', 'Benin', 'ğŸ‡§ğŸ‡¯', 'Africa'),
('bt', 'Bhutan', 'ğŸ‡§ğŸ‡¹', 'Asia'),
('bo', 'Bolivia', 'ğŸ‡§ğŸ‡´', 'South America'),
('ba', 'Bosnia and Herzegovina', 'ğŸ‡§ğŸ‡¦', 'Europe'),
('bw', 'Botswana', 'ğŸ‡§ğŸ‡¼', 'Africa'),
('br', 'Brazil', 'ğŸ‡§ğŸ‡·', 'South America'),
('bn', 'Brunei', 'ğŸ‡§ğŸ‡³', 'Asia'),
('bg', 'Bulgaria', 'ğŸ‡§ğŸ‡¬', 'Europe'),
('bf', 'Burkina Faso', 'ğŸ‡§ğŸ‡«', 'Africa'),
('bi', 'Burundi', 'ğŸ‡§ğŸ‡®', 'Africa'),
('kh', 'Cambodia', 'ğŸ‡°ğŸ‡­', 'Asia'),
('cm', 'Cameroon', 'ğŸ‡¨ğŸ‡²', 'Africa'),
('ca', 'Canada', 'ğŸ‡¨ğŸ‡¦', 'North America'),
('cv', 'Cape Verde', 'ğŸ‡¨ğŸ‡»', 'Africa'),
('cf', 'Central African Republic', 'ğŸ‡¨ğŸ‡«', 'Africa'),
('td', 'Chad', 'ğŸ‡¹ğŸ‡©', 'Africa'),
('cl', 'Chile', 'ğŸ‡¨ğŸ‡±', 'South America'),
('cn', 'China', 'ğŸ‡¨ğŸ‡³', 'Asia'),
('co', 'Colombia', 'ğŸ‡¨ğŸ‡´', 'South America'),
('km', 'Comoros', 'ğŸ‡°ğŸ‡²', 'Africa'),
('cg', 'Congo', 'ğŸ‡¨ğŸ‡¬', 'Africa'),
('cd', 'Congo, Democratic Republic', 'ğŸ‡¨ğŸ‡©', 'Africa'),
('cr', 'Costa Rica', 'ğŸ‡¨ğŸ‡·', 'North America'),
('hr', 'Croatia', 'ğŸ‡­ğŸ‡·', 'Europe'),
('cu', 'Cuba', 'ğŸ‡¨ğŸ‡º', 'North America'),
('cy', 'Cyprus', 'ğŸ‡¨ğŸ‡¾', 'Europe'),
('cz', 'Czech Republic', 'ğŸ‡¨ğŸ‡¿', 'Europe'),
('dk', 'Denmark', 'ğŸ‡©ğŸ‡°', 'Europe'),
('dj', 'Djibouti', 'ğŸ‡©ğŸ‡¯', 'Africa'),
('dm', 'Dominica', 'ğŸ‡©ğŸ‡²', 'North America'),
('do', 'Dominican Republic', 'ğŸ‡©ğŸ‡´', 'North America'),
('ec', 'Ecuador', 'ğŸ‡ªğŸ‡¨', 'South America'),
('eg', 'Egypt', 'ğŸ‡ªğŸ‡¬', 'Africa'),
('sv', 'El Salvador', 'ğŸ‡¸ğŸ‡»', 'North America'),
('gq', 'Equatorial Guinea', 'ğŸ‡¬ğŸ‡¶', 'Africa'),
('er', 'Eritrea', 'ğŸ‡ªğŸ‡·', 'Africa'),
('ee', 'Estonia', 'ğŸ‡ªğŸ‡ª', 'Europe'),
('et', 'Ethiopia', 'ğŸ‡ªğŸ‡¹', 'Africa'),
('fj', 'Fiji', 'ğŸ‡«ğŸ‡¯', 'Oceania'),
('fi', 'Finland', 'ğŸ‡«ğŸ‡®', 'Europe'),
('fr', 'France', 'ğŸ‡«ğŸ‡·', 'Europe'),
('ga', 'Gabon', 'ğŸ‡¬ğŸ‡¦', 'Africa'),
('gm', 'Gambia', 'ğŸ‡¬ğŸ‡²', 'Africa'),
('ge', 'Georgia', 'ğŸ‡¬ğŸ‡ª', 'Asia'),
('de', 'Germany', 'ğŸ‡©ğŸ‡ª', 'Europe'),
('gh', 'Ghana', 'ğŸ‡¬ğŸ‡­', 'Africa'),
('gr', 'Greece', 'ğŸ‡¬ğŸ‡·', 'Europe'),
('gd', 'Grenada', 'ğŸ‡¬ğŸ‡©', 'North America'),
('gt', 'Guatemala', 'ğŸ‡¬ğŸ‡¹', 'North America'),
('gn', 'Guinea', 'ğŸ‡¬ğŸ‡³', 'Africa'),
('gw', 'Guinea-Bissau', 'ğŸ‡¬ğŸ‡¼', 'Africa'),
('gy', 'Guyana', 'ğŸ‡¬ğŸ‡¾', 'South America'),
('ht', 'Haiti', 'ğŸ‡­ğŸ‡¹', 'North America'),
('hn', 'Honduras', 'ğŸ‡­ğŸ‡³', 'North America'),
('hk', 'Hong Kong', 'ğŸ‡­ğŸ‡°', 'Asia'),
('hu', 'Hungary', 'ğŸ‡­ğŸ‡º', 'Europe'),
('is', 'Iceland', 'ğŸ‡®ğŸ‡¸', 'Europe'),
('in', 'India', 'ğŸ‡®ğŸ‡³', 'Asia'),
('id', 'Indonesia', 'ğŸ‡®ğŸ‡©', 'Asia'),
('ir', 'Iran', 'ğŸ‡®ğŸ‡·', 'Asia'),
('iq', 'Iraq', 'ğŸ‡®ğŸ‡¶', 'Asia'),
('ie', 'Ireland', 'ğŸ‡®ğŸ‡ª', 'Europe'),
('il', 'Israel', 'ğŸ‡®ğŸ‡±', 'Asia'),
('it', 'Italy', 'ğŸ‡®ğŸ‡¹', 'Europe'),
('ci', 'Ivory Coast', 'ğŸ‡¨ğŸ‡®', 'Africa'),
('jm', 'Jamaica', 'ğŸ‡¯ğŸ‡²', 'North America'),
('jp', 'Japan', 'ğŸ‡¯ğŸ‡µ', 'Asia'),
('jo', 'Jordan', 'ğŸ‡¯ğŸ‡´', 'Asia'),
('kz', 'Kazakhstan', 'ğŸ‡°ğŸ‡¿', 'Asia'),
('ke', 'Kenya', 'ğŸ‡°ğŸ‡ª', 'Africa'),
('ki', 'Kiribati', 'ğŸ‡°ğŸ‡®', 'Oceania'),
('kp', 'North Korea', 'ğŸ‡°ğŸ‡µ', 'Asia'),
('kr', 'South Korea', 'ğŸ‡°ğŸ‡·', 'Asia'),
('kw', 'Kuwait', 'ğŸ‡°ğŸ‡¼', 'Asia'),
('kg', 'Kyrgyzstan', 'ğŸ‡°ğŸ‡¬', 'Asia'),
('la', 'Laos', 'ğŸ‡±ğŸ‡¦', 'Asia'),
('lv', 'Latvia', 'ğŸ‡±ğŸ‡»', 'Europe'),
('lb', 'Lebanon', 'ğŸ‡±ğŸ‡§', 'Asia'),
('ls', 'Lesotho', 'ğŸ‡±ğŸ‡¸', 'Africa'),
('lr', 'Liberia', 'ğŸ‡±ğŸ‡·', 'Africa'),
('ly', 'Libya', 'ğŸ‡±ğŸ‡¾', 'Africa'),
('li', 'Liechtenstein', 'ğŸ‡±ğŸ‡®', 'Europe'),
('lt', 'Lithuania', 'ğŸ‡±ğŸ‡¹', 'Europe'),
('lu', 'Luxembourg', 'ğŸ‡±ğŸ‡º', 'Europe'),
('mo', 'Macau', 'ğŸ‡²ğŸ‡´', 'Asia'),
('mk', 'North Macedonia', 'ğŸ‡²ğŸ‡°', 'Europe'),
('mg', 'Madagascar', 'ğŸ‡²ğŸ‡¬', 'Africa'),
('mw', 'Malawi', 'ğŸ‡²ğŸ‡¼', 'Africa'),
('my', 'Malaysia', 'ğŸ‡²ğŸ‡¾', 'Asia'),
('mv', 'Maldives', 'ğŸ‡²ğŸ‡»', 'Asia'),
('ml', 'Mali', 'ğŸ‡²ğŸ‡±', 'Africa'),
('mt', 'Malta', 'ğŸ‡²ğŸ‡¹', 'Europe'),
('mh', 'Marshall Islands', 'ğŸ‡²ğŸ‡­', 'Oceania'),
('mr', 'Mauritania', 'ğŸ‡²ğŸ‡·', 'Africa'),
('mu', 'Mauritius', 'ğŸ‡²ğŸ‡º', 'Africa'),
('mx', 'Mexico', 'ğŸ‡²ğŸ‡½', 'North America'),
('fm', 'Micronesia', 'ğŸ‡«ğŸ‡²', 'Oceania'),
('md', 'Moldova', 'ğŸ‡²ğŸ‡©', 'Europe'),
('mc', 'Monaco', 'ğŸ‡²ğŸ‡¨', 'Europe'),
('mn', 'Mongolia', 'ğŸ‡²ğŸ‡³', 'Asia'),
('me', 'Montenegro', 'ğŸ‡²ğŸ‡ª', 'Europe'),
('ma', 'Morocco', 'ğŸ‡²ğŸ‡¦', 'Africa'),
('mz', 'Mozambique', 'ğŸ‡²ğŸ‡¿', 'Africa'),
('mm', 'Myanmar', 'ğŸ‡²ğŸ‡²', 'Asia'),
('na', 'Namibia', 'ğŸ‡³ğŸ‡¦', 'Africa'),
('nr', 'Nauru', 'ğŸ‡³ğŸ‡·', 'Oceania'),
('np', 'Nepal', 'ğŸ‡³ğŸ‡µ', 'Asia'),
('nl', 'Netherlands', 'ğŸ‡³ğŸ‡±', 'Europe'),
('nz', 'New Zealand', 'ğŸ‡³ğŸ‡¿', 'Oceania'),
('ni', 'Nicaragua', 'ğŸ‡³ğŸ‡®', 'North America'),
('ne', 'Niger', 'ğŸ‡³ğŸ‡ª', 'Africa'),
('ng', 'Nigeria', 'ğŸ‡³ğŸ‡¬', 'Africa'),
('no', 'Norway', 'ğŸ‡³ğŸ‡´', 'Europe'),
('om', 'Oman', 'ğŸ‡´ğŸ‡²', 'Asia'),
('pk', 'Pakistan', 'ğŸ‡µğŸ‡°', 'Asia'),
('pw', 'Palau', 'ğŸ‡µğŸ‡¼', 'Oceania'),
('ps', 'Palestine', 'ğŸ‡µğŸ‡¸', 'Asia'),
('pa', 'Panama', 'ğŸ‡µğŸ‡¦', 'North America'),
('pg', 'Papua New Guinea', 'ğŸ‡µğŸ‡¬', 'Oceania'),
('py', 'Paraguay', 'ğŸ‡µğŸ‡¾', 'South America'),
('pe', 'Peru', 'ğŸ‡µğŸ‡ª', 'South America'),
('ph', 'Philippines', 'ğŸ‡µğŸ‡­', 'Asia'),
('pl', 'Poland', 'ğŸ‡µğŸ‡±', 'Europe'),
('pt', 'Portugal', 'ğŸ‡µğŸ‡¹', 'Europe'),
('qa', 'Qatar', 'ğŸ‡¶ğŸ‡¦', 'Asia'),
('ro', 'Romania', 'ğŸ‡·ğŸ‡´', 'Europe'),
('ru', 'Russia', 'ğŸ‡·ğŸ‡º', 'Europe'),
('rw', 'Rwanda', 'ğŸ‡·ğŸ‡¼', 'Africa'),
('kn', 'Saint Kitts and Nevis', 'ğŸ‡°ğŸ‡³', 'North America'),
('lc', 'Saint Lucia', 'ğŸ‡±ğŸ‡¨', 'North America'),
('vc', 'Saint Vincent and the Grenadines', 'ğŸ‡»ğŸ‡¨', 'North America'),
('ws', 'Samoa', 'ğŸ‡¼ğŸ‡¸', 'Oceania'),
('sm', 'San Marino', 'ğŸ‡¸ğŸ‡²', 'Europe'),
('st', 'Sao Tome and Principe', 'ğŸ‡¸ğŸ‡¹', 'Africa'),
('sa', 'Saudi Arabia', 'ğŸ‡¸ğŸ‡¦', 'Asia'),
('sn', 'Senegal', 'ğŸ‡¸ğŸ‡³', 'Africa'),
('rs', 'Serbia', 'ğŸ‡·ğŸ‡¸', 'Europe'),
('sc', 'Seychelles', 'ğŸ‡¸ğŸ‡¨', 'Africa'),
('sl', 'Sierra Leone', 'ğŸ‡¸ğŸ‡±', 'Africa'),
('sg', 'Singapore', 'ğŸ‡¸ğŸ‡¬', 'Asia'),
('sk', 'Slovakia', 'ğŸ‡¸ğŸ‡°', 'Europe'),
('si', 'Slovenia', 'ğŸ‡¸ğŸ‡®', 'Europe'),
('sb', 'Solomon Islands', 'ğŸ‡¸ğŸ‡§', 'Oceania'),
('so', 'Somalia', 'ğŸ‡¸ğŸ‡´', 'Africa'),
('za', 'South Africa', 'ğŸ‡¿ğŸ‡¦', 'Africa'),
('ss', 'South Sudan', 'ğŸ‡¸ğŸ‡¸', 'Africa'),
('es', 'Spain', 'ğŸ‡ªğŸ‡¸', 'Europe'),
('lk', 'Sri Lanka', 'ğŸ‡±ğŸ‡°', 'Asia'),
('sd', 'Sudan', 'ğŸ‡¸ğŸ‡©', 'Africa'),
('sr', 'Suriname', 'ğŸ‡¸ğŸ‡·', 'South America'),
('sz', 'Eswatini', 'ğŸ‡¸ğŸ‡¿', 'Africa'),
('se', 'Sweden', 'ğŸ‡¸ğŸ‡ª', 'Europe'),
('ch', 'Switzerland', 'ğŸ‡¨ğŸ‡­', 'Europe'),
('sy', 'Syria', 'ğŸ‡¸ğŸ‡¾', 'Asia'),
('tw', 'Taiwan', 'ğŸ‡¹ğŸ‡¼', 'Asia'),
('tj', 'Tajikistan', 'ğŸ‡¹ğŸ‡¯', 'Asia'),
('tz', 'Tanzania', 'ğŸ‡¹ğŸ‡¿', 'Africa'),
('th', 'Thailand', 'ğŸ‡¹ğŸ‡­', 'Asia'),
('tl', 'Timor-Leste', 'ğŸ‡¹ğŸ‡±', 'Asia'),
('tg', 'Togo', 'ğŸ‡¹ğŸ‡¬', 'Africa'),
('to', 'Tonga', 'ğŸ‡¹ğŸ‡´', 'Oceania'),
('tt', 'Trinidad and Tobago', 'ğŸ‡¹ğŸ‡¹', 'North America'),
('tn', 'Tunisia', 'ğŸ‡¹ğŸ‡³', 'Africa'),
('tr', 'Turkey', 'ğŸ‡¹ğŸ‡·', 'Asia'),
('tm', 'Turkmenistan', 'ğŸ‡¹ğŸ‡²', 'Asia'),
('tv', 'Tuvalu', 'ğŸ‡¹ğŸ‡»', 'Oceania'),
('ug', 'Uganda', 'ğŸ‡ºğŸ‡¬', 'Africa'),
('ua', 'Ukraine', 'ğŸ‡ºğŸ‡¦', 'Europe'),
('ae', 'United Arab Emirates', 'ğŸ‡¦ğŸ‡ª', 'Asia'),
('gb', 'United Kingdom', 'ğŸ‡¬ğŸ‡§', 'Europe'),
('us', 'United States', 'ğŸ‡ºğŸ‡¸', 'North America'),
('uy', 'Uruguay', 'ğŸ‡ºğŸ‡¾', 'South America'),
('uz', 'Uzbekistan', 'ğŸ‡ºğŸ‡¿', 'Asia'),
('vu', 'Vanuatu', 'ğŸ‡»ğŸ‡º', 'Oceania'),
('va', 'Vatican City', 'ğŸ‡»ğŸ‡¦', 'Europe'),
('ve', 'Venezuela', 'ğŸ‡»ğŸ‡ª', 'South America'),
('vn', 'Vietnam', 'ğŸ‡»ğŸ‡³', 'Asia'),
('ye', 'Yemen', 'ğŸ‡¾ğŸ‡ª', 'Asia'),
('zm', 'Zambia', 'ğŸ‡¿ğŸ‡²', 'Africa'),
('zw', 'Zimbabwe', 'ğŸ‡¿ğŸ‡¼', 'Africa');

-- Spanish passport requirements (sample)
INSERT INTO visa_requirements (from_country_code, to_country_code, status, duration, validity, processing, cost, notes, requirements, last_updated)
VALUES 
('es', 'us', 'visa-free', '90 days', 'Multiple entry', 'ESTA required', '$21 ESTA fee', 'Spanish passport holders can enter the USA under the Visa Waiver Program (VWP) for up to 90 days for tourism or business. An approved ESTA is required before travel.', '["Valid passport with at least 6 months validity","Approved ESTA (Electronic System for Travel Authorization)","Proof of onward travel","Sufficient funds for stay"]'::jsonb, '2023-10-15'),

('es', 'ca', 'visa-free', '180 days', 'Multiple entry', 'eTA required', 'CAD$7 eTA fee', 'Spanish citizens need an Electronic Travel Authorization (eTA) to fly to Canada. No visa required for stays up to 6 months.', '["Valid passport", "Approved eTA", "Proof of sufficient funds"]'::jsonb, '2023-10-15'),

('es', 'gb', 'visa-free', '6 months', 'Multiple entry', 'N/A', 'Free', 'Spanish citizens can visit the UK for up to 6 months without a visa for tourism, business meetings, or visiting friends/family.', '["Valid passport"]'::jsonb, '2023-11-01'),

('es', 'fr', 'visa-free', 'Unlimited', 'N/A', 'N/A', 'Free', 'As an EU citizen, Spanish passport holders have the right to free movement within the European Union.', '["Valid passport or national ID card"]'::jsonb, '2023-10-10'),

('es', 'de', 'visa-free', 'Unlimited', 'N/A', 'N/A', 'Free', 'As an EU citizen, Spanish passport holders have the right to free movement within the European Union.', '["Valid passport or national ID card"]'::jsonb, '2023-10-10'),

('es', 'it', 'visa-free', 'Unlimited', 'N/A', 'N/A', 'Free', 'As an EU citizen, Spanish passport holders have the right to free movement within the European Union.', '["Valid passport or national ID card"]'::jsonb, '2023-10-10'),

('es', 'au', 'e-visa', '90 days', 'Multiple entry', '1-3 business days', 'AUD$20', 'Spanish citizens need to apply for an ETA (Electronic Travel Authority) before traveling to Australia.', '["Valid passport with at least 6 months validity","Online ETA application"]'::jsonb, '2023-07-15'),

('es', 'jp', 'visa-free', '90 days', 'Multiple entry', 'N/A', 'Free', 'Spanish citizens can visit Japan for tourism, business, or visiting friends/relatives without a visa for up to 90 days.', '["Valid passport", "Proof of onward travel", "Sufficient funds for stay"]'::jsonb, '2023-07-15'),

('es', 'cn', 'visa-required', 'Varies by visa type', 'Single or multiple entry', '4-7 business days', 'â‚¬126.55', 'Spanish citizens need to apply for a visa before traveling to China. Different visa types available depending on the purpose of visit.', '["Valid passport with at least 6 months validity and blank pages", "Completed visa application form", "Passport photo meeting requirements", "Proof of travel arrangements", "Invitation letter for some visa types"]'::jsonb, '2023-06-12'),

('es', 'th', 'visa-free', '30 days', 'Single entry', 'N/A', 'Free', 'Spanish passport holders can enter Thailand for tourism without a visa for up to 30 days (when arriving by air).', '["Valid passport with at least 6 months validity", "Proof of onward travel", "Proof of sufficient funds (20,000 THB per person)"]'::jsonb, '2023-05-20');

-- Add default fallback entry
INSERT INTO visa_requirements (from_country_code, to_country_code, status, duration, validity, processing, cost, notes, requirements, last_updated)
VALUES 
('default', 'default', 'unknown', 'Unknown', 'Unknown', 'Unknown', 'Unknown', 'No specific visa information available. Please consult the embassy or consulate of the destination country for accurate visa requirements.', '["Valid passport with at least 6 months validity", "Proof of onward travel", "Proof of sufficient funds", "Check with embassy for detailed requirements"]'::jsonb, '2023-11-01');